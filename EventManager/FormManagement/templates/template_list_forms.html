{% extends "template_listings_base.html" %}

{% block PageTittle %}
    Form Listings
{% endblock %}

{% block selectType %}Evento{% endblock %}

{% block listingTittle %}{{formType.typename}} Forms{% endblock %}

{% block filterTypes %}
    {% for eventType in eventTypes %}
        <option>{{eventType.typename}}</option>
    {% endfor %}	
{% endblock %}

{% block currentPage %}Formulários de {{formType}}{% endblock %}

{% block preListingBlock %}
    {% load form_extras %}
    {% if formType|can_create_form_fromType:user %}
    <a href="{% url 'createForm' formType.id %}">
        <button type="button" class="button is-success is-outlined" style="margin-bottom: 1rem;"><span
                class="icon is-small"><i class="mdi mdi-plus"></i></span> <span>Adicionar Formulário de {{formType.typename}}</span>
        </button>
    </a>
    {% endif %}
{% endblock %}

{% block tableHead %}
    <th style="width: 15%;">Nome</th>
    <th style="width: 5%;">Tipo</th>
    <th style="width: 8%;">Tipo de Evento</th>
    <th style="width: 5%;">Publico</th>
    <th style="width: 5%;">Arquivado</th>
    <th style="width: 5%;">Criador</th>
    <th style="width: 10%;">Criado em</th>
    <th style="width: 5%;">Editado por</th>
    <th style="width: 10%;">Editado em</th>
    <th style="width: 20%;">Ações</th>
{% endblock %}

{% block listings %}
    {% load form_extras %}
    {% for form in forms %}
        {% if form|can_display_form:user %}
            <tr id="row{{ forloop.counter }}">
                <td id="NameFilter{{ forloop.counter }}">{{form.formname}}</td>
                <td>{{form.formtypeid_formtype}}</td>
                <td id="TypeFilter{{ forloop.counter }}">{{form.eventtypeid.typename}}</td>
                <td id="PublishedFilter{{ forloop.counter }}">{% if form.published %}Sim{% else %}Não{% endif %}</td>
                <td id="ArchivedFilter{{ forloop.counter }}">{% if form.archived %}Sim{% else %}Não{% endif %}</td>
                <td id="CriatorFilter{{ forloop.counter }}">{{form.createdby.username}}</td>
                <td id="CriationDateFilter{{ forloop.counter }}">{{form.dateofcreation}}</td>
                <td id="EditorFilter{{ forloop.counter }}">{{form.lasteditedby.username}}</td>
                <td id="EditDateFilter{{ forloop.counter }}">{{form.dateoflastedit}}</td>
                <td>
                    <a href="{% url 'checkFormLayout' form.id %}" class="icon has-text-info button is-white" style="vertical-align: middle;" data-tooltip="Ver Formulário">
                        <i class="fa fa-search fa-lg" aria-hidden="true"></i>
                    </a>
                    
                    {% if form.canEdit %}
                        <a href="{% url 'createForm' form.formtypeid_formtype.id form.id %}" class="icon has-text-info button is-white" style="vertical-align: middle;" data-tooltip="Editar Formulário">
                            <i class="mdi mdi-circle-edit-outline mdi-24px" aria-hidden="true"></i>
                        </a>
                        <a href="{% url 'deleteForm' form.id %}" class="icon has-text-info button is-white" style="vertical-align: middle;" data-tooltip="Eliminar Formulário" onclick="return confirm('Tem a certeza que deseja apagar este formulário?');">
                            <i class="fas fa-times fa-lg" aria-hidden="true"></i>
                        </a>
                    {% else %}
                        <a class="icon has-text-info button is-white" style="vertical-align: middle;" data-tooltip="Editar Formulário" disabled>
                            <i class="mdi mdi-circle-edit-outline mdi-24px" aria-hidden="true"></i>
                        </a>
                        <a class="icon has-text-info button is-white" style="vertical-align: middle;" data-tooltip="Eliminar Formulário" disabled>
                            <i class="fas fa-times fa-lg" aria-hidden="true"></i>
                        </a>
                    {% endif %}
                    
                    {% if not form.archived %}
                        {% if form|can_archive_form:user %}
                            <a href="{% url 'archiveForm' form.id %}" class="icon has-text-info button is-white" style="vertical-align: middle;" data-tooltip="Arquivar Formulário" onclick="return confirm('Após arquivar o formulário não sera possivél associar este a novos eventos nem a sua edição. Deseja continuar?');">
                                <i class="fas fa-archive fa-lg" aria-hidden="true"></i>
                            </a>
                        {% else %}
                            <a class="icon has-text-info button is-white" style="vertical-align: middle;" data-tooltip="Arquivar Formulário" disabled>
                                <i class="fas fa-archive fa-lg" aria-hidden="true"></i>
                            </a>
                        {% endif %}

                        
                        {% if form.published %}
                            <a class="icon has-text-info button is-white" style="vertical-align: middle;" data-tooltip="Publicar" disabled>
                                <i class="fas fa-eye fa-lg" aria-hidden="true"></i>
                            </a>
                        {% elif form|can_publish_form:user %}
                            <a href="{% url 'publishForm' form.id %}" class="icon has-text-info button is-white" style="vertical-align: middle;" data-tooltip="Publicar">
                                <i class="fas fa-eye fa-lg" aria-hidden="true"></i>
                            </a>
                        {% endif %}
                        
                    {% else %}
                        {% if form|can_unarchive_form:user %}
                            <a href="{% url 'unarchiveForm' form.id %}" class="icon has-text-info button is-white" style="vertical-align: middle;" data-tooltip="Desarquivar Formulário" onclick="return confirm('Após arquivar o formulário não sera possivél associar este a novos eventos nem a sua edição. Deseja continuar?');">
                                <i class="fas fa-archive fa-lg" aria-hidden="true"></i>
                            </a>
                        {% else %}
                            <a class="icon has-text-info button is-white" style="vertical-align: middle;" data-tooltip="Arquivar Formulário" disabled>
                                <i class="fas fa-archive fa-lg" aria-hidden="true"></i>
                            </a>
                        {% endif %}
                        <a class="icon has-text-info button is-white" style="vertical-align: middle;" data-tooltip="Publicar" disabled>
                            <i class="fas fa-eye fa-lg" aria-hidden="true"></i>
                        </a>
                    {% endif %}

                    {% if form.canDuplicate %}
                        <a href="{% url 'duplicateForm' form.id %}" class="icon has-text-info button is-white" style="vertical-align: middle;" data-tooltip="Duplicar Formulário" onclick="return confirm('Esta ação irá arquivar o atual formulário de proposta para eventos do tipo {{form.eventtypeid.typename}}. Tem a certeza que quer continuar?');">
                            <i class="far fa-clone" aria-hidden="true"></i>
                        </a>
                    {% else %}
                        <a class="icon has-text-info button is-white" style="vertical-align: middle;" data-tooltip="Duplicar Questão" disabled>
                            <i class="far fa-clone" aria-hidden="true"></i>
                        </a>
                    {% endif %}
                </td>
            </tr>
        {% endif %}
    {% endfor %}
{% endblock %}
